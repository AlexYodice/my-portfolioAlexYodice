<!DOCTYPE html>
<html>
<head>
    <title>Verify Password Hash</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .container {
            background: #2a2a2a;
            padding: 30px;
            border-radius: 10px;
        }
        h1 { color: #dc3545; }
        .hash-comparison {
            background: #0a0a0a;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
        .match { color: #28a745; }
        .mismatch { color: #dc3545; }
        pre {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
        button {
            background: #dc3545;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover { background: #c82333; }
        .update-btn { background: #28a745; }
        .update-btn:hover { background: #218838; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Verify Password Hash</h1>
        
        <p><strong>Database Hash:</strong></p>
        <pre>9bd73e75e55a424442b3006e23b5a1a7503e39e867e6fc6baf35424008609d86</pre>
        
        <p><strong>Enter password to verify:</strong></p>
        <input type="password" id="password" value="Taylorjmjr1959" placeholder="Enter password" style="width: 100%; padding: 10px; margin: 10px 0; border-radius: 5px; background: #333; color: #fff; border: 1px solid #555;">
        
        <button onclick="verifyHash()">Verify Hash</button>
        <button onclick="generateUpdateSQL()" class="update-btn">Generate Update SQL</button>
        
        <div id="result" class="hash-comparison" style="display: none;">
            <h3 id="resultTitle"></h3>
            <pre id="resultContent"></pre>
            <div id="sqlOutput" style="display: none; margin-top: 20px;">
                <h3>Copy this SQL to update the password:</h3>
                <pre id="sqlContent"></pre>
                <button onclick="copySQL()">Copy SQL</button>
            </div>
        </div>
    </div>

    <script>
        const DB_HASH = '9bd73e75e55a424442b3006e23b5a1a7503e39e867e6fc6baf35424008609d86';

        async function hashPassword(password) {
            const encoder = new TextEncoder();
            const data = encoder.encode(password);
            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
            return hashHex;
        }

        async function verifyHash() {
            const password = document.getElementById('password').value;
            if (!password) {
                alert('Please enter a password');
                return;
            }

            const generatedHash = await hashPassword(password);
            const matches = generatedHash === DB_HASH;

            const resultDiv = document.getElementById('result');
            const resultTitle = document.getElementById('resultTitle');
            const resultContent = document.getElementById('resultContent');

            if (matches) {
                resultTitle.innerHTML = '<span class="match">‚úÖ HASHES MATCH!</span>';
                resultTitle.className = 'match';
                resultContent.textContent = `Generated Hash: ${generatedHash}\nDatabase Hash:  ${DB_HASH}\n\n‚úÖ The password is correct!`;
            } else {
                resultTitle.innerHTML = '<span class="mismatch">‚ùå HASHES DON\'T MATCH</span>';
                resultTitle.className = 'mismatch';
                resultContent.textContent = `Generated Hash: ${generatedHash}\nDatabase Hash:  ${DB_HASH}\n\n‚ùå The password hash doesn't match!\n\nThis means either:\n1. You're typing the wrong password\n2. The hash in the database is wrong\n\nClick "Generate Update SQL" to fix it.`;
            }

            resultDiv.style.display = 'block';
        }

        async function generateUpdateSQL() {
            const password = document.getElementById('password').value;
            if (!password) {
                alert('Please enter a password');
                return;
            }

            const newHash = await hashPassword(password);
            const sql = `UPDATE public.admin_users SET password_hash = '${newHash}' WHERE username = 'al3x';`;

            document.getElementById('sqlContent').textContent = sql;
            document.getElementById('sqlOutput').style.display = 'block';
            document.getElementById('result').style.display = 'block';
        }

        function copySQL() {
            const sql = document.getElementById('sqlContent').textContent;
            navigator.clipboard.writeText(sql).then(() => {
                alert('SQL copied to clipboard!');
            }).catch(() => {
                alert('Failed to copy. Please select and copy manually.');
            });
        }
    </script>
</body>
</html>

